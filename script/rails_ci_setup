#!/usr/bin/env bash

config() {
  teamcity_version=5.0.3
  config_dir=~/.railsci
  mkdir -p $config_dir
}

__enable_rvm() {
  rvm_init='if [[ -s /home/ubuntu/.rvm/scripts/rvm ]] ; then source /home/ubuntu/.rvm/scripts/rvm ; fi'
  if rvm_line=$(grep '.rvm' ~/.bashrc); test -z "$rvm_line"; then
    echo $rvm_init >> $init_file
  fi
  sed -i'.bak' -e 's/ && return.*$//' $init_file
}

setup_rvm() {
  bash < <(curl http://rvm.beginrescueend.com/releases/rvm-install-latest)
  for init_file in ~/.bashrc ~/.bash_profile
  do
    __enable_rvm
  done
}

setup_all() {
  setup_rvm
}

config
setup_all
